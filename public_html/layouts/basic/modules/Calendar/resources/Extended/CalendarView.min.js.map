{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n/**\n *  Class representing an extended calendar.\n * @extends Calendar_Calendar_Js\n */\nwindow.Calendar_CalendarExtended_Js = class extends Calendar_Calendar_Js {\n\n\tconstructor(container, readonly) {\n\t\tsuper(container, readonly);\n\t\tthis.sidebarView = {\n\t\t\tlength: 0\n\t\t};\n\t\tthis.calendarContainer = false;\n\t\tthis.addCommonMethodsToYearView();\n\t\tthis.calendar = this.getCalendarView();\n\t}\n\n\t/**\n\t * Function extends FC.views.year with current class methods\n\t */\n\taddCommonMethodsToYearView() {\n\t\tconst self = this;\n\t\tFC.views.year = FC.views.year.extend({\n\t\t\tselectDays: self.selectDays,\n\t\t\tgetCalendarCreateView: self.getCalendarCreateView,\n\t\t\tgetSidebarView: self.getSidebarView,\n\t\t\tgetCurrentCvId: self.getCurrentCvId,\n\t\t\tgetCalendarView: self.getCalendarView,\n\t\t\tshowRightPanelForm: self.showRightPanelForm,\n\t\t\tgetSelectedUsersCalendar: self.getSelectedUsersCalendar,\n\t\t\tregisterClearFilterButton: self.registerClearFilterButton,\n\t\t\tclearFilterButton: self.clearFilterButton,\n\t\t\tregisterFilterTabChange: self.registerFilterTabChange,\n\t\t\tsidebarView: self.sidebarView,\n\t\t\tregisterAfterSubmitForm: self.registerAfterSubmitForm,\n\t\t\tregisterViewRenderEvents: self.registerViewRenderEvents,\n\t\t\tappendSubDateRow: self.appendSubDateRow,\n\t\t\trefreshDatesRowView: self.refreshDatesRowView,\n\t\t\tgenerateYearList: self.generateYearList,\n\t\t\tupdateCountTaskCalendar: self.updateCountTaskCalendar,\n\t\t\tregisterDatesChange: self.registerDatesChange,\n\t\t\taddHeaderButtons: self.addHeaderButtons,\n\t\t\tbrowserHistoryConfig: self.browserHistoryConfig,\n\t\t\treadonly: self.readonly,\n\t\t\tcontainer: self.container,\n\t\t\tshowChangeDateButtons: self.showChangeDateButtons,\n\t\t\tshowTodayButtonCheckbox: self.showTodayButtonCheckbox\n\t\t});\n\t}\n\n\t/**\n\t * Render calendar\n\t */\n\trenderCalendar() {\n\t\tlet self = this,\n\t\t\tbasicOptions = this.setCalendarOptions(),\n\t\t\toptions = {\n\t\t\t\tfirstLoad: true,\n\t\t\t\theader: {\n\t\t\t\t\tleft: 'year,month,' + app.getMainParams('weekView') + ',' + app.getMainParams('dayView'),\n\t\t\t\t\tcenter: 'prevYear,prev,title,next,nextYear',\n\t\t\t\t\tright: 'today'\n\t\t\t\t},\n\t\t\t\teditable: !self.readonly,\n\t\t\t\tviews: {\n\t\t\t\t\tbasic: {\n\t\t\t\t\t\teventLimit: false,\n\t\t\t\t\t},\n\t\t\t\t\tyear: {\n\t\t\t\t\t\teventLimit: 10,\n\t\t\t\t\t\teventLimitText: app.vtranslate('JS_COUNT_RECORDS'),\n\t\t\t\t\t\ttitleFormat: 'YYYY',\n\t\t\t\t\t\tselect: function (start, end) {\n\t\t\t\t\t\t},\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.getCalendarView().fullCalendar('getCalendar').view.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmonth: {\n\t\t\t\t\t\ttitleFormat: 'YYYY MMMM',\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tweek: {\n\t\t\t\t\t\ttitleFormat: 'YYYY MMM D',\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tday: {\n\t\t\t\t\t\ttitleFormat: 'YYYY MMM D',\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tbasicDay: {\n\t\t\t\t\t\ttype: 'agendaDay',\n\t\t\t\t\t\tloadView: function () {\n\t\t\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tselect: function (start, end) {\n\t\t\t\t\tself.selectDays(start, end);\n\t\t\t\t\tself.getCalendarView().fullCalendar('unselect');\n\t\t\t\t},\n\t\t\t\teventRender: function (event, element) {\n\t\t\t\t\tself.eventRenderer(event, element);\n\t\t\t\t},\n\t\t\t\tviewRender: function (view, element) {\n\t\t\t\t\tif (view.type !== 'year') {\n\t\t\t\t\t\tself.loadCalendarData(view);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\taddCalendarEvent(calendarDetails) {\n\t\t\t\t\tself.getCalendarView().fullCalendar('renderEvent', self.getEventData(calendarDetails));\n\t\t\t\t}\n\t\t\t};\n\t\toptions = Object.assign(basicOptions, options);\n\t\tif (!this.readonly) {\n\t\t\toptions.eventClick = function (calEvent, jsEvent) {\n\t\t\t\tjsEvent.preventDefault();\n\t\t\t\tself.getCalendarSidebarData($(this).attr('href'));\n\t\t\t};\n\t\t} else {\n\t\t\toptions.eventClick = '';\n\t\t}\n\t\tthis.calendar.fullCalendar(options);\n\t}\n\n\tregisterChangeView() {\n\t}\n\n\taddHeaderButtons() {\n\t\tif (this.calendarContainer.find('.js-calendar__view-btn').length) {\n\t\t\treturn;\n\t\t}\n\t\tlet buttonsContainer = this.calendarContainer.prev('.js-calendar__header-buttons'),\n\t\t\tviewBtn = buttonsContainer.find('.js-calendar__view-btn').clone(),\n\t\t\tfilters = buttonsContainer.find('.js-calendar__filter-container').clone();\n\t\tthis.calendarContainer.find('.fc-left').prepend(viewBtn);\n\t\tthis.calendarContainer.find('.fc-center').after(filters);\n\t\tthis.registerClearFilterButton();\n\t\tthis.registerFilterTabChange();\n\t}\n\n\tregisterSwitchEvents() {\n\t\tconst calendarView = this.getCalendarView();\n\t\tlet isWorkDays,\n\t\t\tswitchShowTypeVal,\n\t\t\tswitchContainer = $('.js-calendar__tab--filters'),\n\t\t\tswitchShowType = switchContainer.find('.js-switch--showType'),\n\t\t\tswitchSwitchingDays = switchContainer.find('.js-switch--switchingDays');\n\t\tlet historyParams = app.getMainParams('historyParams', true);\n\t\tif (historyParams === '') {\n\t\t\tisWorkDays = (app.getMainParams('switchingDays') === 'workDays' && app.moduleCacheGet('defaultSwitchingDays') !== 'all'),\n\t\t\t\tswitchShowTypeVal = (app.getMainParams('showType') === 'current' && app.moduleCacheGet('defaultShowType') !== 'history');\n\t\t\tif (!switchShowTypeVal) {\n\t\t\t\tswitchShowType.find('.js-switch--label-off').button('toggle');\n\t\t\t}\n\t\t} else {\n\t\t\tapp.setMainParams('showType', historyParams.time);\n\t\t\tapp.setMainParams('switchingDays', historyParams.hiddenDays === '' ? 'all' : 'workDays');\n\n\t\t}\n\t\tswitchShowType.on('change', 'input', (e) => {\n\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\tapp.setMainParams('showType', 'current');\n\t\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\tapp.setMainParams('showType', 'history');\n\t\t\t\tapp.moduleCacheSet('defaultShowType', 'history');\n\t\t\t}\n\t\t\tcalendarView.fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t\tif (switchSwitchingDays.length) {\n\t\t\tif (typeof isWorkDays !== 'undefined' && !isWorkDays) {\n\t\t\t\tswitchSwitchingDays.find('.js-switch--label-off').button('toggle');\n\t\t\t}\n\t\t\tswitchSwitchingDays.on('change', 'input', (e) => {\n\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\tlet hiddenDays = [];\n\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('switchingDays', 'workDays');\n\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'workDays');\n\t\t\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('switchingDays', 'all');\n\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'all');\n\t\t\t\t}\n\t\t\t\tcalendarView.fullCalendar('option', 'hiddenDays', hiddenDays);\n\t\t\t\tcalendarView.fullCalendar('option', 'height', this.setCalendarHeight());\n\t\t\t\tif (calendarView.fullCalendar('getView').type === 'year') {\n\t\t\t\t\tthis.registerViewRenderEvents(calendarView.fullCalendar('getView'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Appends subdate row to calendar header and register its scroll\n\t * @param toolbar\n\t */\n\tappendSubDateRow(toolbar) {\n\t\tif (!this.calendarContainer.find('.js-dates-row').length) {\n\t\t\tthis.subDateRow = $(`\n\t\t\t\t\t\t\t\t<div class=\"js-scroll js-dates-row u-overflow-auto-lg-down order-4 flex-grow-1 position-relative my-1 w-100\" data-js=\"perfectScrollbar | container\">\n\t\t\t\t\t\t\t\t\t<div class=\"d-flex flex-nowrap w-100\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"js-sub-date-list w-100 sub-date-list row no-gutters flex-nowrap nav nav-tabs\" data-js=\"data-type\"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`);\n\t\t\ttoolbar.append(this.subDateRow);\n\t\t\tif ($(window).width() > app.breakpoints.lg) {\n\t\t\t\tapp.showNewScrollbar(this.subDateRow, {\n\t\t\t\t\tsuppressScrollY: true\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Function toggles next year/month and general arrows on view render\n\t * @param view\n\t * @param element\n\t */\n\tregisterViewRenderEvents(view) {\n\t\tthis.calendarContainer = this.getCalendarView();\n\t\tlet toolbar = this.calendarContainer.find('.fc-toolbar.fc-header-toolbar');\n\t\tthis.showChangeDateButtons(view, toolbar);\n\t\tthis.appendSubDateRow(toolbar);\n\t\tthis.refreshDatesRowView(view);\n\t\tthis.addHeaderButtons();\n\t\tthis.showTodayButtonCheckbox(toolbar);\n\t}\n\n\t/**\n\t * Function appends and shows today button's checkbox\n\t * @param {jQuery} toolbar\n\t */\n\tshowTodayButtonCheckbox(toolbar) {\n\t\tlet todayButton = toolbar.find('.fc-today-button'),\n\t\t\ttodyButtonIcon = todayButton.hasClass('fc-state-disabled') ? 'fa-calendar-check' : 'fa-calendar',\n\t\t\tpopoverContent = `${app.vtranslate('JS_CURRENT')} ${toolbar.find('.fc-state-active').text().toLowerCase()}`;\n\t\ttodayButton.removeClass('.fc-button');\n\t\ttodayButton.html(`<div class=\"js-popover-tooltip--day-btn\" data-toggle=\"popover\"><span class=\"far fa-lg ${todyButtonIcon}\"></span></div>`)\n\t\tapp.showPopoverElementView(todayButton.find('.js-popover-tooltip--day-btn'), {\n\t\t\tcontent: popoverContent,\n\t\t\tcontainer: '.fc-today-button .js-popover-tooltip--day-btn'\n\t\t});\n\t}\n\n\t/**\n\t * Function shows change date buttons in calendar's header for specific view\n\t * @param view\n\t * @param toolbar\n\t */\n\tshowChangeDateButtons(view, toolbar) {\n\t\tlet viewType = view.type,\n\t\t\tnextPrevButtons = toolbar.find('.fc-prev-button, .fc-next-button'),\n\t\t\tyearButtons = toolbar.find('.fc-prevYear-button, .fc-nextYear-button');\n\t\tif (viewType === 'agendaWeek') {\n\t\t\tviewType = 'week'\n\t\t} else if (viewType === 'agendaDay') {\n\t\t\tviewType = 'day';\n\t\t}\n\t\tif (view.options.firstLoad) {\n\t\t\tyearButtons.first().html(`<span class=\"fas small fa-minus mr-1\"></span>${view.options.buttonText['year']}`);\n\t\t\tyearButtons.last().html(`${view.options.buttonText['year']}<span class=\"fas small fa-plus ml-1\"></span>`);\n\t\t}\n\t\tif (view.type !== 'year') {\n\t\t\tnextPrevButtons.first().html(`<span class=\"fas small fa-minus mr-1\"></span>${view.options.buttonText[viewType]}`);\n\t\t\tnextPrevButtons.last().html(`${view.options.buttonText[viewType]}<span class=\"fas small fa-plus ml-1\"></span>`);\n\t\t}\n\t\tif (view.type === 'year') {\n\t\t\tnextPrevButtons.hide();\n\t\t\tyearButtons.show();\n\t\t} else if (view.type === 'month') {\n\t\t\tnextPrevButtons.show();\n\t\t\tyearButtons.show();\n\t\t} else {\n\t\t\tnextPrevButtons.show();\n\t\t\tyearButtons.hide();\n\t\t}\n\t}\n\n\t/**\n\t * Date bar with counts\n\t * @param object calendarView\n\t */\n\trefreshDatesRowView(calendarView) {\n\t\tconst self = this;\n\t\tswitch (calendarView.type) {\n\t\t\tcase 'year':\n\t\t\t\tself.generateYearList(calendarView.intervalStart, calendarView.intervalEnd);\n\t\t\t\tbreak;\n\t\t\tcase 'month':\n\t\t\t\tself.generateSubMonthList(calendarView.intervalStart, calendarView.intervalEnd);\n\t\t\t\tbreak;\n\t\t\tcase 'week':\n\t\t\tcase 'agendaWeek':\n\t\t\t\tself.generateSubWeekList(calendarView.start, calendarView.end);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tself.generateSubDaysList(calendarView.start, calendarView.end);\n\t\t}\n\t\tself.updateCountTaskCalendar();\n\t\tself.registerDatesChange();\n\t}\n\n\tregisterDatesChange() {\n\t\tthis.container.find('.js-dates-row .js-sub-record').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\tcurrentTarget.addClass('active');\n\t\t\tthis.getCalendarView().fullCalendar('gotoDate', moment(currentTarget.data('date'), \"YYYY-MM-DD\"));\n\t\t});\n\t}\n\n\tgetCurrentCvId() {\n\t\treturn $(\".js-calendar__extended-filter-tab .active\").parent('.js-filter-tab').data('cvid');\n\t}\n\n\tregisterFilterTabChange() {\n\t\tconst thisInstance = this;\n\t\tthis.getCalendarView().find(\".js-calendar__extended-filter-tab\").on('shown.bs.tab', function () {\n\t\t\tthisInstance.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t}\n\n\tgetSelectedUsersCalendar() {\n\t\tconst sidebar = this.getSidebarView();\n\t\tlet selectedUsers = sidebar.find('.js-input-user-owner-id:checked'),\n\t\t\tselectedUsersAjax = sidebar.find('.js-input-user-owner-id-ajax'),\n\t\t\tselectedRolesAjax = sidebar.find('.js-input-role-owner-id-ajax'),\n\t\t\tusers = [];\n\t\tif (selectedUsers.length > 0) {\n\t\t\tselectedUsers.each(function () {\n\t\t\t\tusers.push($(this).val());\n\t\t\t});\n\t\t} else if (selectedUsersAjax.length > 0) {\n\t\t\tusers = selectedUsersAjax.val().concat(selectedRolesAjax.val());\n\t\t}\n\t\treturn users;\n\t}\n\n\tgetSidebarView() {\n\t\tif (!this.sidebarView.length) {\n\t\t\tthis.sidebarView = $('#rightPanel');\n\t\t}\n\t\treturn this.sidebarView;\n\t}\n\n\tupdateCountTaskCalendar() {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tsubDatesElements = datesView.find('.js-sub-record'),\n\t\t\tdateArray = {},\n\t\t\tuserDateFormat = CONFIG.dateFormat.toUpperCase(),\n\t\t\tuser = this.getSelectedUsersCalendar();\n\t\tif (user.length === 0) {\n\t\t\tuser = app.getMainParams('usersId');\n\t\t}\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tsubDatesElements.each(function (key, element) {\n\t\t\tlet data = $(this).data('date'),\n\t\t\t\ttype = $(this).data('type');\n\t\t\tif (type === 'years') {\n\t\t\t\tdateArray[key] = [moment(data + '-01').format(userDateFormat) + ' 00:00:00', moment(data + '-01').endOf('year').format(userDateFormat) + ' 23:59:59'];\n\t\t\t} else if (type === 'months') {\n\t\t\t\tdateArray[key] = [moment(data).format(userDateFormat) + ' 00:00:00', moment(data).endOf('month').format(userDateFormat) + ' 23:59:59'];\n\t\t\t} else if (type === 'weeks') {\n\t\t\t\tdateArray[key] = [moment(data).format(userDateFormat) + ' 00:00:00', moment(data).add(6, 'day').format(userDateFormat) + ' 23:59:59'];\n\t\t\t} else if (type === 'days') {\n\t\t\t\tdateArray[key] = [moment(data).format(userDateFormat) + ' 00:00:00', moment(data).format(userDateFormat) + ' 23:59:59'];\n\t\t\t}\n\t\t});\n\t\tAppConnector.request({\n\t\t\tmodule: 'Calendar',\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'getCountEventsGroup',\n\t\t\tdates: dateArray,\n\t\t\tuser: user,\n\t\t\ttime: app.getMainParams('showType'),\n\t\t\tcvid: this.getCurrentCvId()\n\t\t}).done(function (events) {\n\t\t\tsubDatesElements.each(function (key, element) {\n\t\t\t\t$(this).find('.js-count-events').removeClass('hide').html(events.result[key]);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Register events to EditView\n\t * @param {jQuery} sideBar\n\t */\n\tregisterEditForm(sideBar) {\n\t\tlet editViewInstance = Vtiger_Edit_Js.getInstanceByModuleName(sideBar.find('[name=\"module\"]').val()),\n\t\t\theaderInstance = new Vtiger_Header_Js(),\n\t\t\tparams = [];\n\t\tlet rightFormCreate = sideBar.find('form[name=\"QuickCreate\"]');\n\t\teditViewInstance.registerBasicEvents(rightFormCreate);\n\t\trightFormCreate.validationEngine(app.validationEngineOptions);\n\t\theaderInstance.registerHelpInfo(rightFormCreate);\n\t\tApp.Fields.Picklist.showSelect2ElementView(sideBar.find('select'));\n\t\tsideBar.find('.js-summary-close-edit').on('click', () => {\n\t\t\tthis.getCalendarCreateView();\n\t\t});\n\t\tparams.callbackFunction = this.registerAfterSubmitForm(this, rightFormCreate);\n\t\theaderInstance.registerQuickCreatePostLoadEvents(rightFormCreate, params);\n\t\tnew App.Fields.Text.Editor(sideBar.find('.js-editor'), {height: '5em', toolbar: 'Min'});\n\t}\n\n\t/**\n\t * EditView\n\t * @param {Object}|{number} params\n\t */\n\tgetCalendarSidebarData(params) {\n\t\tconst thisInstance = this,\n\t\t\taDeferred = $.Deferred();\n\t\tconst progressInstance = $.progressIndicator({blockInfo: {enabled: true}});\n\t\tif ($.isNumeric(params)) {\n\t\t\tparams = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'EventForm',\n\t\t\t\trecord: params\n\t\t\t};\n\t\t}\n\t\tAppConnector.request(params).done((data) => {\n\t\t\tthisInstance.openRightPanel();\n\t\t\tprogressInstance.progressIndicator({mode: 'hide'});\n\t\t\tlet sideBar = thisInstance.getSidebarView();\n\t\t\tsideBar.find('.js-qc-form').html(data);\n\t\t\tthisInstance.showRightPanelForm();\n\t\t\tif (sideBar.find('form').length) {\n\t\t\t\tthisInstance.registerEditForm(sideBar);\n\t\t\t} else {\n\t\t\t\tapp.showNewScrollbar(sideBar.find('.js-calendar__form__wrapper'), {suppressScrollX: true});\n\t\t\t\tsideBar.find('.js-activity-state .js-summary-close-edit').on('click', function () {\n\t\t\t\t\tthisInstance.getCalendarCreateView();\n\t\t\t\t});\n\t\t\t\tsideBar.find('.js-activity-state .editRecord').on('click', function () {\n\t\t\t\t\tthisInstance.getCalendarSidebarData($(this).data('id'));\n\t\t\t\t});\n\t\t\t}\n\t\t\taDeferred.resolve(sideBar.find('.js-qc-form'));\n\t\t}).fail((error) => {\n\t\t\tprogressInstance.progressIndicator({mode: 'hide'});\n\t\t\tapp.errorLog(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\tloadCalendarData(view = this.getCalendarView().fullCalendar('getView')) {\n\t\tconst self = this;\n\t\tlet formatDate = CONFIG.dateFormat.toUpperCase(),\n\t\t\tcvid = self.getCurrentCvId(),\n\t\t\tcalendarInstance = this.getCalendarView();\n\t\tcalendarInstance.fullCalendar('removeEvents');\n\t\tlet progressInstance = $.progressIndicator({blockInfo: {enabled: true}}),\n\t\t\tuser = self.getSelectedUsersCalendar();\n\t\tif (0 === user.length) {\n\t\t\tuser = app.getMainParams('usersId');\n\t\t}\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tself.clearFilterButton(user, cvid);\n\t\tif (view.type === 'agendaDay') {\n\t\t\tself.selectDays(view.start, view.end);\n\t\t\tview.end = view.end.add(1, 'day');\n\t\t}\n\t\tlet options = {\n\t\t\tmodule: 'Calendar',\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'getEvents',\n\t\t\tstart: view.start.format(formatDate),\n\t\t\tend: view.end.format(formatDate),\n\t\t\tuser: user,\n\t\t\ttime: app.getMainParams('showType'),\n\t\t\tcvid: cvid,\n\t\t\thistoryUrl: `index.php?module=Calendar&view=CalendarExtended&history=true&viewType=${view.type}&start=${view.start.format(formatDate)}&end=${view.end.format(formatDate)}&user=${user}&time=${app.getMainParams('showType')}&cvid=${cvid}&hiddenDays=${view.options.hiddenDays}`\n\t\t};\n\t\tlet connectorMethod = window[\"AppConnector\"][\"request\"];\n\t\tif (!this.readonly) {\n\t\t\tconnectorMethod = window[\"AppConnector\"][\"requestPjax\"];\n\t\t}\n\t\tconnectorMethod(options).done((events) => {\n\t\t\tcalendarInstance.fullCalendar('removeEvents');\n\t\t\tcalendarInstance.fullCalendar('addEventSource', events.result);\n\t\t\tprogressInstance.progressIndicator({mode: 'hide'});\n\t\t});\n\t\tself.registerViewRenderEvents(view);\n\t\tview.options.firstLoad = false;\n\t}\n\n\tclearFilterButton(user, cvid) {\n\t\tlet currentUser = parseInt(app.getMainParams('userId')),\n\t\t\ttime = app.getMainParams('showType'),\n\t\t\tstatement = ((user.length === 0 || (user.length === 1 && parseInt(user) === currentUser)) && cvid === undefined && time === 'current');\n\t\t$(\".js-calendar__clear-filters\").toggleClass('d-none', statement);\n\t}\n\n\tregisterClearFilterButton() {\n\t\tconst sidebar = this.getSidebarView(),\n\t\t\tcalendarView = this.getCalendarView();\n\t\tlet clearBtn = calendarView.find('.js-calendar__clear-filters');\n\t\tapp.showPopoverElementView(clearBtn);\n\t\tclearBtn.on('click', () => {\n\t\t\t$(\".js-calendar__extended-filter-tab a\").removeClass('active');\n\t\t\tapp.setMainParams('showType', 'current');\n\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\tsidebar.find(\"input:checkbox\").prop('checked', false);\n\t\t\tsidebar.find(\"option:selected\").prop('selected', false);\n\t\t\tlet calendarSwitch = sidebar.find('.js-switch--showType [class*=\"js-switch--label\"]');\n\t\t\tcalendarSwitch.last().removeClass('active');\n\t\t\tcalendarSwitch.first().addClass('active');\n\t\t\tsidebar.find(\".js-input-user-owner-id[value=\" + app.getMainParams('userId') + \"]\").prop('checked', true);\n\t\t\tcalendarView.fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t}\n\n\tgenerateYearList(dateStart, dateEnd) {\n\t\tconst datesView = this.container.find('.js-dates-row');\n\t\tlet prevYear = moment(dateStart).subtract(1, 'year'),\n\t\t\tactualYear = moment(dateStart),\n\t\t\tnextYear = moment(dateStart).add(1, 'year'),\n\t\t\thtml = '',\n\t\t\tactive = '';\n\t\twhile (prevYear <= nextYear) {\n\t\t\tif (prevYear.format('YYYY') === actualYear.format('YYYY')) {\n\t\t\t\tactive = 'active';\n\t\t\t} else {\n\t\t\t\tactive = '';\n\t\t\t}\n\t\t\thtml +=\n\t\t\t\t`<div class=\"js-sub-record sub-record col-4 nav-item\" data-date=\"${prevYear.format('YYYY')}\" data-type=\"years\" data-js=\"click | class: active\">\n\t\t\t\t\t<div class=\"sub-record-content nav-link ${active}\">\n\t\t\t\t\t\t<div class=\"sub-date-name\">\n\t\t\t\t\t\t\t${prevYear.format('YYYY')}\n\t\t\t\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t\t\tprevYear = moment(prevYear).add(1, 'year');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tgenerateSubMonthList(dateStart, dateEnd) {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tactiveMonth = parseInt(moment(dateStart).locale('en').format('M')) - 1,\n\t\t\thtml = '',\n\t\t\tactive = '';\n\t\tfor (let month = 0; 12 > month; ++month) {\n\t\t\tif (month === activeMonth) {\n\t\t\t\tactive = 'active';\n\t\t\t} else {\n\t\t\t\tactive = '';\n\t\t\t}\n\t\t\thtml +=\n\t\t\t\t`<div class=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"months\" data-date=\"${moment(dateStart).month(month).format('YYYY-MM')}\" data-js=\"click | class: active\">\n\t\t\t\t\t<div class=\"sub-record-content nav-link ${active}\">\n\t\t\t\t\t\t<div class=\"sub-date-name\">${app.vtranslate('JS_' + moment().month(month).format('MMM').toUpperCase()).toUpperCase()}\n\t\t\t\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tgenerateSubWeekList(dateStart, dateEnd) {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tprevWeeks = moment(dateStart).subtract(5, 'weeks'),\n\t\t\tactualWeek = moment(dateStart).format('WW'),\n\t\t\tnextWeeks = moment(dateStart).add(6, 'weeks'),\n\t\t\thtml = '';\n\t\twhile (prevWeeks <= nextWeeks) {\n\t\t\tlet active = '';\n\t\t\tif (prevWeeks.format('WW') === actualWeek) {\n\t\t\t\tactive = ' active';\n\t\t\t}\n\t\t\thtml += '<div class=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"weeks\" data-date=\"' + prevWeeks.format('YYYY-MM-DD') + '\" data-js=\"click | class: active\">' +\n\t\t\t\t'<div class=\"sub-record-content nav-link' + active + '\">' +\n\t\t\t\t'<div class=\"sub-date-name\">' + app.vtranslate('JS_WEEK_SHORT') + ' ' + prevWeeks.format('WW') +\n\t\t\t\t'<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>';\n\t\t\tprevWeeks = moment(prevWeeks).add(1, 'weeks');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tgenerateSubDaysList(dateStart, dateEnd) {\n\t\tlet datesView = this.container.find('.js-dates-row'),\n\t\t\tprevDays = moment(dateStart).subtract(5, 'days'),\n\t\t\tactualDay = moment(dateStart).format('DDD'),\n\t\t\tnextDays = moment(dateStart).add(7, 'days'),\n\t\t\tdaysToShow = nextDays.diff(prevDays, 'days'),\n\t\t\thtml = '';\n\t\tfor (let day = 0; day < daysToShow; ++day) {\n\t\t\tlet active = '';\n\t\t\tif (app.getMainParams('switchingDays') === 'workDays' && app.moduleCacheGet('defaultSwitchingDays') !== 'all') {\n\t\t\t\tif ($.inArray(prevDays.day(), app.getMainParams('hiddenDays', true)) !== -1) {\n\t\t\t\t\tprevDays = moment(prevDays).add(1, 'days');\n\t\t\t\t\tdaysToShow++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (prevDays.format('DDD') === actualDay) {\n\t\t\t\tactive = ' active';\n\t\t\t}\n\t\t\thtml += '<div class=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"days\" data-date=\"' + prevDays.format('YYYY-MM-DD') + '\" data-js=\"click | class: active\">' +\n\t\t\t\t'<div class=\"sub-record-content nav-link' + active + '\">' +\n\t\t\t\t'<div class=\"sub-date-name\">' + app.vtranslate('JS_DAY_SHORT') + ' ' + prevDays.format('DD') +\n\t\t\t\t'<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>';\n\t\t\tprevDays = moment(prevDays).add(1, 'days');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\n\tselectDays(startDate, endDate) {\n\t\tthis.container.find('.js-right-panel-event-link').tab('show');\n\t\tlet start_hour = app.getMainParams('startHour'),\n\t\t\tend_hour = app.getMainParams('endHour'),\n\t\t\tview = this.getCalendarView().fullCalendar('getView');\n\t\tif (endDate.hasTime() == false) {\n\t\t\tendDate.add(-1, 'days');\n\t\t}\n\t\tstartDate = startDate.format();\n\t\tendDate = endDate.format();\n\t\tif (start_hour == '') {\n\t\t\tstart_hour = '00';\n\t\t}\n\t\tif (end_hour == '') {\n\t\t\tend_hour = '00';\n\t\t}\n\t\tthis.getCalendarCreateView().done(function (data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (view.name != 'agendaDay' && view.name != 'agendaWeek') {\n\t\t\t\tstartDate = startDate + 'T' + start_hour + ':00';\n\t\t\t\tendDate = endDate + 'T' + end_hour + ':00';\n\t\t\t\tif (startDate == endDate) {\n\t\t\t\t\tlet activityType = data.find('[name=\"activitytype\"]').val();\n\t\t\t\t\tlet activityDurations = JSON.parse(data.find('[name=\"defaultOtherEventDuration\"]').val());\n\t\t\t\t\tlet minutes = 0;\n\t\t\t\t\tfor (let i in activityDurations) {\n\t\t\t\t\t\tif (activityDurations[i].activitytype === activityType) {\n\t\t\t\t\t\t\tminutes = parseInt(activityDurations[i].duration);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tendDate = moment(endDate).add(minutes, 'minutes').toISOString();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet dateFormat = data.find('[name=\"date_start\"]').data('dateFormat').toUpperCase(),\n\t\t\t\ttimeFormat = data.find('[name=\"time_start\"]').data('format'),\n\t\t\t\tdefaultTimeFormat = '';\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t\t} else {\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\t}\n\t\t\tdata.find('[name=\"date_start\"]').val(moment(startDate).format(dateFormat));\n\t\t\tdata.find('[name=\"due_date\"]').val(moment(endDate).format(dateFormat));\n\t\t\tif (data.find('.js-autofill').prop('checked') === true) {\n\t\t\t\tCalendar_Edit_Js.getInstance().getFreeTime(data);\n\t\t\t} else {\n\t\t\t\tdata.find('[name=\"time_start\"]').val(moment(startDate).format(defaultTimeFormat));\n\t\t\t\tdata.find('[name=\"time_end\"]').val(moment(endDate).format(defaultTimeFormat));\n\t\t\t}\n\t\t});\n\t}\n\n\tregisterUsersChange(formContainer) {\n\t\tformContainer.find('.js-input-user-owner-id-ajax, .js-input-user-owner-id').on('change', () => {\n\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t\tthis.registerPinUser();\n\t}\n\n\t/**\n\t * Register actions to do after save record\n\t * @param instance\n\t * @param data\n\t * @returns {function}\n\t */\n\tregisterAfterSubmitForm(self, data) {\n\t\tconst calendarView = this.getCalendarView();\n\t\tlet returnFunction = function (data) {\n\t\t\tif (data.success) {\n\t\t\t\tlet recordActivityStatus = data.result.activitystatus.value,\n\t\t\t\t\thistoryStatus = app.getMainParams('activityStateLabels', true).history,\n\t\t\t\t\tinHistoryStatus = $.inArray(recordActivityStatus, historyStatus),\n\t\t\t\t\tshowType = app.getMainParams('showType');\n\t\t\t\tif ((-1 !== inHistoryStatus && 'history' === showType) || (-1 === inHistoryStatus && 'history' !== showType)) {\n\t\t\t\t\tif (calendarView.fullCalendar('clientEvents', data.result._recordId)[0]) {\n\t\t\t\t\t\tself.updateCalendarEvent(data.result._recordId, data.result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst calendarInstance = calendarView.fullCalendar('getCalendar');\n\t\t\t\t\t\tif (calendarInstance.view.type !== 'year') {\n\t\t\t\t\t\t\tcalendarInstance.view.options.addCalendarEvent(data.result);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcalendarInstance.view.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.result.followup.value !== undefined) {\n\t\t\t\t\t\t\tcalendarView.fullCalendar('removeEvents', data.result.followup.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.refreshDatesRowView(calendarView.fullCalendar('getView'));\n\t\t\t\tself.getSidebarView().find('.js-qc-form').html('');\n\t\t\t\tself.getCalendarCreateView();\n\t\t\t\twindow.popoverCache = {};\n\t\t\t}\n\t\t};\n\t\treturn returnFunction;\n\t}\n\n\topenRightPanel() {\n\t\tlet calendarRightPanel = $('.js-calendar-right-panel');\n\t\tif (calendarRightPanel.hasClass('hideSiteBar')) {\n\t\t\tcalendarRightPanel.find('.js-toggle-site-bar-right-button').trigger('click');\n\t\t}\n\t}\n\n\tshowRightPanelForm() {\n\t\tlet calendarRightPanel = $('.js-calendar-right-panel');\n\t\tif (!calendarRightPanel.find('.js-right-panel-event').hasClass('active')) {\n\t\t\tcalendarRightPanel.find('.js-right-panel-event-link').trigger('click');\n\t\t}\n\t\tapp.showNewScrollbar(calendarRightPanel.find('.js-calendar__form__wrapper'), {\n\t\t\tsuppressScrollX: true\n\t\t});\n\t}\n\n\tregisterSiteBarEvents() {\n\t\tlet calendarRightPanel = $('.js-calendar-right-panel');\n\t\tcalendarRightPanel.find('.js-show-sitebar').on('click', () => {\n\t\t\tif (calendarRightPanel.hasClass('hideSiteBar')) {\n\t\t\t\tcalendarRightPanel.find('.js-toggle-site-bar-right-button').trigger('click');\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Parse calendar data\n\t * @param {Object} calendarDetails\n\t * @returns {{id: *, title: *, start: *, end: *, module: string, url: string, className: string[], start_display: *, end_display: *}}\n\t */\n\tgetEventData(calendarDetails) {\n\t\tlet calendar = this.getCalendarView(),\n\t\t\tstartDate = calendar.fullCalendar('moment', calendarDetails.date_start.value + ' ' + calendarDetails.time_start.value),\n\t\t\tendDate = calendar.fullCalendar('moment', calendarDetails.due_date.value + ' ' + calendarDetails.time_end.value),\n\t\t\teventObject = {\n\t\t\t\tid: calendarDetails._recordId,\n\t\t\t\ttitle: calendarDetails.subject.display_value,\n\t\t\t\tstart: startDate.format(),\n\t\t\t\tend: endDate.format(),\n\t\t\t\tmodule: 'Calendar',\n\t\t\t\turl: 'index.php?module=Calendar&view=ActivityState&record=' + calendarDetails._recordId,\n\t\t\t\tclassName: ['ownerCBg_' + calendarDetails.assigned_user_id.value, ' picklistCBr_Calendar_activitytype_' + calendarDetails.activitytype.value, 'js-popover-tooltip--record'],\n\t\t\t\tstart_display: calendarDetails.date_start.display_value,\n\t\t\t\tend_display: calendarDetails.due_date.display_value\n\t\t\t};\n\t\tif (calendarDetails.isEditable && app.getMainParams('showEditForm')) {\n\t\t\teventObject.url = 'index.php?module=Calendar&view=EventForm&record=' + eventObject.id;\n\t\t}\n\t\treturn eventObject;\n\t}\n\n\t/**\n\t * Update Event\n\t * @param {Number} calendarEventId\n\t * @param {Object} calendarDetails\n\t */\n\tupdateCalendarEvent(calendarEventId, calendarDetails) {\n\t\tconst calendar = this.getCalendarView();\n\t\tlet recordToUpdate = calendar.fullCalendar('clientEvents', calendarEventId)[0];\n\t\t$.extend(recordToUpdate, this.getEventData(calendarDetails));\n\t\tcalendar.fullCalendar('updateEvent', recordToUpdate);\n\t}\n\n\tgetCalendarCreateView() {\n\t\tconst thisInstance = this;\n\t\tlet sideBar = thisInstance.getSidebarView(),\n\t\t\tqcForm = sideBar.find('.js-qc-form'),\n\t\t\taDeferred = $.Deferred();\n\t\tif (qcForm.find('form').length > 0 && qcForm.find('input[name=record]').length === 0) {\n\t\t\taDeferred.resolve(qcForm);\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t\tlet progressInstance = $.progressIndicator({blockInfo: {enabled: true}});\n\t\tthis.getCalendarSidebarData({'module': app.getModuleName(), 'view': 'EventForm',}).done(() => {\n\t\t\tprogressInstance.progressIndicator({mode: 'hide'});\n\t\t\tthisInstance.registerAutofillTime();\n\t\t\taDeferred.resolve(qcForm);\n\t\t}).fail((error) => {\n\t\t\tprogressInstance.progressIndicator({mode: 'hide'});\n\t\t\tapp.errorLog(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Autoselect date in create view in extended calendar\n\t */\n\tregisterAutofillTime() {\n\t\tif (app.getMainParams('autofillTime')) {\n\t\t\tthis.container.find('.js-autofill').prop('checked', 'checked').trigger('change');\n\t\t}\n\t}\n\n\tregisterPinUser() {\n\t\t$('.js-pin-user').off('click').on('click', function () {\n\t\t\tconst thisInstance = $(this);\n\t\t\tAppConnector.request({\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'action': 'Calendar',\n\t\t\t\t'mode': 'pinOrUnpinUser',\n\t\t\t\t'element_id': thisInstance.data('elementid'),\n\t\t\t}).done((data) => {\n\t\t\t\tlet response = data.result;\n\t\t\t\tif (response === 'unpin') {\n\t\t\t\t\tthisInstance.find('.js-pin-icon').removeClass('fas').addClass('far');\n\t\t\t\t} else if (response === 'pin') {\n\t\t\t\t\tthisInstance.find('.js-pin-icon').removeClass('far').addClass('fas');\n\t\t\t\t} else {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(app.vtranslate('JS_ERROR'));\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tregisterAddForm() {\n\t\tconst thisInstance = this;\n\t\tlet sideBar = thisInstance.getSidebarView();\n\t\tthisInstance.getCalendarCreateView();\n\t\tlet user = app.getMainParams('usersId');\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tAppConnector.request(`index.php?module=Calendar&view=RightPanelExtended&mode=getUsersList&user=${user}`).done(\n\t\t\tfunction (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tlet formContainer = sideBar.find('.js-users-form');\n\t\t\t\t\tformContainer.html(data);\n\t\t\t\t\tthisInstance.registerUsersChange(formContainer);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(formContainer.find('select'));\n\t\t\t\t\tapp.showNewScrollbar(formContainer, {\n\t\t\t\t\t\tsuppressScrollX: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tAppConnector.request(`index.php?module=Calendar&view=RightPanelExtended&mode=getGroupsList&user=${user}`).done(\n\t\t\tfunction (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tlet formContainer = sideBar.find('.js-group-form');\n\t\t\t\t\tformContainer.html(data);\n\t\t\t\t\tthisInstance.registerUsersChange(formContainer);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(formContainer.find('select'));\n\t\t\t\t\tformContainer.addClass('u-min-h-30per');\n\t\t\t\t\tapp.showNewScrollbar(formContainer, {\n\t\t\t\t\t\tsuppressScrollX: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Find element on list (user, group)\n\t * @param {jQuery.Event} e\n\t */\n\tfindElementOnList(e) {\n\t\tlet target = $(e.target),\n\t\t\tvalue = target.val().toLowerCase(),\n\t\t\tcontainer = target.closest('.js-filter__container');\n\t\tcontainer.find('.js-filter__item__value').filter(function () {\n\t\t\tlet item = $(this).closest('.js-filter__item__container');\n\t\t\tif ($(this).text().trim().toLowerCase().indexOf(value) > -1) {\n\t\t\t\titem.removeClass('d-none');\n\t\t\t} else {\n\t\t\t\titem.addClass('d-none');\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Register filter for users and groups\n\t */\n\tregisterFilterForm() {\n\t\tconst self = this;\n\t\tthis.getSidebarView().find('a[data-toggle=\"tab\"]').one('shown.bs.tab', function (e) {\n\t\t\t$(\".js-filter__search\").on('keyup', self.findElementOnList.bind(self));\n\t\t});\n\t}\n\n\t/**\n\t * Register popover buttons' click\n\t */\n\tregistetPopoverButtonsClickEvent() {\n\t\t$(document).on('click', '.js-calendar-popover__button', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.getCalendarSidebarData($(e.currentTarget).attr('href'));\n\t\t});\n\t}\n\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerAddForm();\n\t\tthis.registerSiteBarEvents();\n\t\tthis.registerFilterForm();\n\t\tthis.registetPopoverButtonsClickEvent();\n\t\tElementQueries.listen();\n\t}\n}\n"],"names":["window","Calendar_CalendarExtended_Js","container","readonly","sidebarView","length","calendarContainer","addCommonMethodsToYearView","calendar","getCalendarView","FC","views","year","extend","selectDays","self","getCalendarCreateView","getSidebarView","getCurrentCvId","showRightPanelForm","getSelectedUsersCalendar","registerClearFilterButton","clearFilterButton","registerFilterTabChange","registerAfterSubmitForm","registerViewRenderEvents","appendSubDateRow","refreshDatesRowView","generateYearList","updateCountTaskCalendar","registerDatesChange","addHeaderButtons","browserHistoryConfig","showChangeDateButtons","showTodayButtonCheckbox","basicOptions","setCalendarOptions","options","firstLoad","header","left","app","getMainParams","center","right","editable","basic","eventLimit","eventLimitText","vtranslate","titleFormat","select","loadView","fullCalendar","view","render","month","loadCalendarData","week","day","basicDay","type","start","end","eventRender","event","element","eventRenderer","viewRender","addCalendarEvent","calendarDetails","getEventData","Object","assign","eventClick","calEvent","jsEvent","preventDefault","getCalendarSidebarData","$","attr","find","prev","viewBtn","buttonsContainer","clone","filters","prepend","after","calendarView","isWorkDays","switchShowTypeVal","switchContainer","switchShowType","switchSwitchingDays","historyParams","moduleCacheGet","button","setMainParams","time","hiddenDays","on","e","currentTarget","data","moduleCacheSet","setCalendarHeight","toolbar","subDateRow","append","width","breakpoints","lg","showNewScrollbar","suppressScrollY","todyButtonIcon","todayButton","hasClass","popoverContent","text","toLowerCase","removeClass","html","showPopoverElementView","content","nextPrevButtons","yearButtons","viewType","first","buttonText","last","hide","show","intervalStart","intervalEnd","generateSubMonthList","generateSubWeekList","generateSubDaysList","addClass","moment","parent","thisInstance","selectedUsers","sidebar","selectedUsersAjax","selectedRolesAjax","users","each","push","val","concat","subDatesElements","datesView","dateArray","userDateFormat","CONFIG","dateFormat","toUpperCase","user","key","format","endOf","add","AppConnector","request","module","action","mode","dates","cvid","done","events","result","sideBar","editViewInstance","Vtiger_Edit_Js","getInstanceByModuleName","headerInstance","params","rightFormCreate","registerBasicEvents","validationEngine","validationEngineOptions","registerHelpInfo","App","Fields","Picklist","showSelect2ElementView","callbackFunction","registerQuickCreatePostLoadEvents","Text","Editor","height","aDeferred","Deferred","progressInstance","progressIndicator","blockInfo","enabled","isNumeric","getModuleName","record","openRightPanel","registerEditForm","suppressScrollX","resolve","fail","error","errorLog","promise","formatDate","calendarInstance","historyUrl","connectorMethod","parseInt","statement","currentUser","toggleClass","clearBtn","prop","calendarSwitch","dateStart","prevYear","subtract","actualYear","nextYear","active","activeMonth","locale","prevWeeks","actualWeek","nextWeeks","prevDays","actualDay","nextDays","daysToShow","diff","inArray","startDate","endDate","tab","end_hour","hasTime","start_hour","name","activityDurations","JSON","parse","minutes","i","activitytype","activityType","duration","toISOString","timeFormat","defaultTimeFormat","Calendar_Edit_Js","getInstance","getFreeTime","formContainer","registerPinUser","success","activitystatus","value","historyStatus","history","inHistoryStatus","recordActivityStatus","showType","_recordId","updateCalendarEvent","followup","popoverCache","calendarRightPanel","trigger","date_start","time_start","due_date","time_end","eventObject","id","title","subject","display_value","url","className","assigned_user_id","start_display","end_display","isEditable","calendarEventId","recordToUpdate","qcForm","registerAutofillTime","off","Vtiger_Helper_Js","showPnotify","registerUsersChange","target","closest","filter","trim","indexOf","item","one","findElementOnList","bind","document","registerAddForm","registerSiteBarEvents","registerFilterForm","registetPopoverButtonsClickEvent","ElementQueries","listen","Calendar_Calendar_Js"],"mappings":"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"}